{{ define "authflowv2/__locale_input.html" }}

{{
  $languageOptions := (list
    (dict
      "code" ""
      "displayLabel" (include "v2.component.locale-input.default.options.not-provided" nil)
    )
  )
}}
{{ range $language := $.Languages }}
  {{ $labelKey := (printf "language-%s" $language)}}
  {{
    $languageOptions = append $languageOptions (dict
      "code" $language
      "displayLabel" (include $labelKey nil)
    )
  }}
{{ end }}

<div
  data-controller="custom-select body-scroll-lock locale-input"
  data-locale-input-target="localeSelect"
  data-locale-input-languages-value="{{ toJson $languageOptions }}"
  data-action="custom-select:open->body-scroll-lock#lock custom-select:close->body-scroll-lock#unlock"
>
  <input
    type="text"
    class="hidden"
    data-custom-select-target="input"
    name="{{ .Name }}"
    value="{{ .Locale }}"
  />

  <!-- Select Button -->
  <button
    type="button"
    class="w-full text-left locale-input__trigger"
    aria-haspopup="listbox"
    aria-expanded="false"
    data-custom-select-target="trigger"
    data-action="click->custom-select#toggle"
  ></button>

  <!-- Dropdown Menu -->
  <div
    class="select__dropdown-container hidden"
    data-custom-select-target="dropdownContainer"
  >
    <div
      class="select__dropdown"
      role="listbox"
      data-custom-select-target="dropdown"
    >
      <ul
        class="select__options"
        data-custom-select-target="options"
      >
      </ul>

      <template data-custom-select-target="searchTemplate">
        <div class="select__search-container">
          <div class="select__search">
            <input
              class="select__search-input"
              placeholder="{{ translate "v2.component.locale-input.default.search-label" . }}"
              data-controller="dismiss-keyboard-on-scroll"
              data-custom-select-target="search"
              data-action="input->custom-select#search"
            >
            <div class="select__search-icon">
              <i class="material-icons">search</i>
            </div>
            <button
              class="select__clear-icon"
              type="button"
              tabindex="-1"
              data-custom-select-target="clearSearch"
              data-action="click->custom-select#clearSearch"
            >
              <i class="material-icons material-icons--filled">cancel</i>
            </button>
          </div>
          <button
            class="select__close-icon"
            type="button"
            tabindex="-1"
            data-action="click->custom-select#close"
          >
            <i class="material-icons">close</i>
          </button>
        </div>
      </template>

      <template data-custom-select-target="itemTemplate">
        <li
          class="select__option"
          role="option"
          data-action="click->custom-select#handleSelect keydown->custom-select#handleKeyDown"
          tabindex="-1"
        >
          <span data-label="content" class="select__option-content"></span>
        </li>
      </template>

      <template data-custom-select-target="emptyTemplate">
        <li class="select__empty">
          {{ translate "v2.component.locale-input.default.no-results-found" . }}
        </li>
      </template>
    </div>
  </div>
</div>

{{ end }}
