part: WorkflowReauthFlow
name: valid
error: null
value:
  id: id
  steps:
  - type: authenticate
    one_of:
    - authentication: primary_passkey
      steps:
      - type: authenticate
        optional: true
        one_of:
        - authentication: secondary_totp
    - authentication: primary_password

---
part: WorkflowReauthFlow
name: invalid
error: |-
  invalid value:
  /steps/0/one_of/0/authentication: enum
    map[actual:foobar expected:[primary_password primary_passkey primary_oob_otp_email primary_oob_otp_sms secondary_password secondary_totp secondary_oob_otp_email secondary_oob_otp_sms]]
  /steps/0/one_of/0/steps/0/one_of/0/authentication: enum
    map[actual:foobar expected:[primary_password primary_passkey primary_oob_otp_email primary_oob_otp_sms secondary_password secondary_totp secondary_oob_otp_email secondary_oob_otp_sms]]
  /steps/0/one_of/0/steps/0/optional: type
    map[actual:[string] expected:[boolean]]
  /steps/0/one_of/1/authentication: enum
    map[actual:foobar expected:[primary_password primary_passkey primary_oob_otp_email primary_oob_otp_sms secondary_password secondary_totp secondary_oob_otp_email secondary_oob_otp_sms]]
value:
  id: id
  steps:
  - type: authenticate
    one_of:
    - authentication: foobar
      steps:
      - type: authenticate
        optional: "1"
        one_of:
        - authentication: foobar
    - authentication: foobar
