// Code generated by Wire. DO NOT EDIT.

//go:generate go run github.com/google/wire/cmd/wire
//go:build !wireinject
// +build !wireinject

package service

import (
	"github.com/authgear/authgear-server/pkg/lib/audit"
	"github.com/authgear/authgear-server/pkg/lib/config"
	"github.com/authgear/authgear-server/pkg/lib/deps"
	"github.com/authgear/authgear-server/pkg/lib/hook"
	"github.com/authgear/authgear-server/pkg/lib/infra/db/auditdb"
	"github.com/authgear/authgear-server/pkg/portal/model"
	"github.com/authgear/authgear-server/pkg/util/clock"
	"github.com/authgear/authgear-server/pkg/util/log"
)

// Injectors from wire.go:

func newAuditSink(app *model.App, auditDatabase *auditdb.WriteHandle, loggerFactory *log.Factory) *audit.Sink {
	logger := audit.NewLogger(loggerFactory)
	appContext := app.Context
	config := appContext.Config
	secretConfig := config.SecretConfig
	auditDatabaseCredentials := deps.ProvideAuditDatabaseCredentials(secretConfig)
	appConfig := config.AppConfig
	appID := appConfig.ID
	sqlBuilderApp := auditdb.NewSQLBuilderApp(auditDatabaseCredentials, appID)
	writeSQLExecutor := auditdb.NewWriteSQLExecutor(auditDatabase)
	writeStore := &audit.WriteStore{
		SQLBuilder:  sqlBuilderApp,
		SQLExecutor: writeSQLExecutor,
	}
	sink := &audit.Sink{
		Logger:   logger,
		Database: auditDatabase,
		Store:    writeStore,
	}
	return sink
}

func newHookSink(app *model.App, denoEndpoint config.DenoEndpoint, loggerFactory *log.Factory) *hook.Sink {
	logger := hook.NewLogger(loggerFactory)
	appContext := app.Context
	configConfig := appContext.Config
	appConfig := configConfig.AppConfig
	hookConfig := appConfig.Hook
	clock := _wireSystemClockValue
	webHookLogger := hook.NewWebHookLogger(loggerFactory)
	secretConfig := configConfig.SecretConfig
	webhookKeyMaterials := deps.ProvideWebhookKeyMaterials(secretConfig)
	webHookImpl := hook.WebHookImpl{
		Logger: webHookLogger,
		Secret: webhookKeyMaterials,
	}
	syncHTTPClient := hook.NewSyncHTTPClient(hookConfig)
	asyncHTTPClient := hook.NewAsyncHTTPClient()
	eventWebHookImpl := &hook.EventWebHookImpl{
		WebHookImpl: webHookImpl,
		SyncHTTP:    syncHTTPClient,
		AsyncHTTP:   asyncHTTPClient,
	}
	manager := appContext.Resources
	denoHookLogger := hook.NewDenoHookLogger(loggerFactory)
	denoHook := hook.DenoHook{
		ResourceManager: manager,
		Logger:          denoHookLogger,
	}
	syncDenoClient := hook.NewSyncDenoClient(denoEndpoint, hookConfig, logger)
	asyncDenoClient := hook.NewAsyncDenoClient(denoEndpoint, logger)
	eventDenoHookImpl := &hook.EventDenoHookImpl{
		DenoHook:        denoHook,
		SyncDenoClient:  syncDenoClient,
		AsyncDenoClient: asyncDenoClient,
	}
	noopAttributesService := _wireNoopAttributesServiceValue
	noopRolesAndGroupsService := _wireNoopRolesAndGroupsServiceValue
	sink := &hook.Sink{
		Logger:             logger,
		Config:             hookConfig,
		Clock:              clock,
		EventWebHook:       eventWebHookImpl,
		EventDenoHook:      eventDenoHookImpl,
		StandardAttributes: noopAttributesService,
		CustomAttributes:   noopAttributesService,
		RolesAndGroups:     noopRolesAndGroupsService,
	}
	return sink
}

var (
	_wireSystemClockValue               = clock.NewSystemClock()
	_wireNoopAttributesServiceValue     = &NoopAttributesService{}
	_wireNoopRolesAndGroupsServiceValue = &NoopRolesAndGroupsService{}
)
